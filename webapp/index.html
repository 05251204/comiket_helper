<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>ComiPath - Comiket TSP</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700&display=swap"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <h1><i class="fa-solid fa-route"></i> ComiPath</h1>
      <button id="toggle-settings" class="settings-btn" aria-label="設定">
        <i class="fa-solid fa-gear"></i>
      </button>
    </header>

    <div class="container">
      <!-- 設定エリア -->
      <div id="settings-area" class="card">
        <h2>設定</h2>
        <div class="input-group">
          <label for="gas-url">GAS Web App URL</label>
          <div class="input-row">
            <input
              type="text"
              id="gas-url"
              placeholder="https://script.google.com/..."
              style="text-align: left"
            />
            <button
              id="btn-refresh"
              class="btn btn-secondary"
              style="width: auto"
            >
              <i class="fa-solid fa-rotate"></i>
            </button>
          </div>
        </div>
        <p
          style="font-size: 0.8rem; color: var(--text-sub); margin-top: 0.5rem"
        >
          ※URLを入力して更新ボタンを押してください
        </p>
      </div>

      <!-- 現在地入力 -->
      <div class="card">
        <h2>現在地</h2>
        <div class="location-controls">
          <select id="loc-ewsn"></select>
          <select id="loc-label"></select>
          <input type="number" id="loc-number" value="1" min="1" max="99" />
        </div>
        <button
          id="btn-search"
          class="btn btn-primary"
          style="margin-top: 1rem"
        >
          <i class="fa-solid fa-magnifying-glass"></i> 次の目的地を検索
        </button>
      </div>

      <!-- 次の目的地 -->
      <div id="next-target" class="card">
        <div id="target-loading" class="loading-overlay hidden">
          <i class="fa-solid fa-spinner fa-spin"></i> 計算中...
        </div>

        <div id="target-content" class="hidden">
          <div class="target-header">
            <span class="target-label">NEXT TARGET</span>
            <h1 id="target-space-heading">---</h1>
          </div>

          <div class="target-meta">
            <span class="meta-item"
              ><i class="fa-solid fa-person-walking"></i>
              <span id="target-dist">-</span></span
            >
            <span class="meta-item"
              ><i class="fa-solid fa-star"></i>
              <span id="target-priority">-</span></span
            >
          </div>

          <a id="target-tweet-link" href="#" target="_blank" class="tweet-link">
            <i class="fa-brands fa-twitter"></i> お品書き / Twitter
          </a>

          <div id="tweet-embed-container" class="tweet-preview"></div>

          <div class="action-grid">
            <button id="btn-purchased" class="btn btn-success">
              <i class="fa-solid fa-check"></i> 購入済
            </button>
            <button id="btn-hold" class="btn btn-warning">
              <i class="fa-solid fa-pause"></i> 保留
            </button>
            <button id="btn-undo" class="btn btn-undo">
              <i class="fa-solid fa-rotate-left"></i> 直前の操作を取り消す
            </button>
          </div>
        </div>

        <div id="target-empty" class="empty-state">
          <i
            class="fa-regular fa-map"
            style="font-size: 2rem; margin-bottom: 0.5rem"
          ></i>
          <p>現在地を入力して<br />検索ボタンを押してください</p>
        </div>
      </div>

      <!-- ステータス -->
      <div class="card">
        <h2>残りサークル数</h2>
        <div class="stats-grid">
          <div class="stat-item">
            東456 <span id="count-e456" class="stat-badge">0</span>
          </div>
          <div class="stat-item">
            東7 <span id="count-e7" class="stat-badge">0</span>
          </div>
          <div class="stat-item">
            西12 <span id="count-w12" class="stat-badge">0</span>
          </div>
          <div class="stat-item">
            南12 <span id="count-s12" class="stat-badge">0</span>
          </div>
          <div
            id="btn-hold-list"
            class="stat-item hold"
            style="grid-column: span 2"
          >
            保留中 <span id="count-hold" class="stat-badge">0</span>
            <i
              class="fa-solid fa-chevron-right"
              style="font-size: 0.8rem; margin-left: auto"
            ></i>
          </div>
        </div>
        <button
          id="btn-reset-all"
          class="btn btn-danger"
          style="margin-top: 1.5rem"
        >
          <i class="fa-solid fa-trash"></i> 購入リストをリセット
        </button>
      </div>
    </div>

    <div id="toast"></div>

    <!-- Twitter Widgets -->
    <script
      async
      src="https://platform.twitter.com/widgets.js"
      charset="utf-8"
    ></script>

    <!-- Main Script (Module) -->
    <script type="module" src="js/app.js"></script>
  </body>
</html>
